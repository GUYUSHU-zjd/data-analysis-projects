---
// 1. 获取动态路由参数和项目数据
import { getCollection } from 'astro:content';
export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}
const { project } = Astro.props;
// 2. 渲染Markdown内容
const { Content } = await project.render();
---

<!-- 3. 页面HTML模板 -->
<html lang="zh">
  <head>
    <title>{project.data.title} | 我的作品集</title>
    <meta name="description" content={project.data.description} />
  </head>
  <body>
    <article>
      <!-- 项目头部 -->
      <header>
        <h1>{project.data.title}</h1>
        <p>{project.data.description}</p>
        <time datetime={project.data.pubDate.toISOString()}>
          完成日期: {project.data.pubDate.toLocaleDateString('zh-CN')}
        </time>
        <div>
          {/* 技能标签云 */}
          {project.data.tools.map((tool) => (
            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm mr-2">{tool}</span>
          ))}
        </div>
        {/* 项目链接 */}
        <div class="my-4">
          <a href={project.data.github_url} target="_blank" class="btn btn-primary">查看完整代码</a>
          {project.data.demo_url && (
            <a href={project.data.demo_url} target="_blank" class="btn btn-secondary">查看在线演示</a>
          )}
        </div>
      </header>

      <hr />

      <!-- 项目正文内容 (来自Markdown) -->
      <div class="prose prose-lg max-w-none">
        <Content />
      </div>

      <!-- 在这里嵌入你的自定义图表组件 -->
      <div class="my-12">
        <h2>关键指标可视化</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <h3>销售额月度趋势</h3>
            <!-- 调用你之前在 components/charts/ 里创建的组件 -->
            <BarChart client:load />
          </div>
          <div>
            <h3>产品类别分布</h3>
            <!-- 另一个图表 -->
            <CustomViz client:visible />
          </div>
        </div>
      </div>
    </article>
  </body>
</html>

<style>
  /* 可选的局部样式 */
  .btn {
    @apply inline-block px-4 py-2 rounded font-medium no-underline mr-4;
  }
  .btn-primary {
    @apply bg-blue-600 text-white hover:bg-blue-700;
  }
  .btn-secondary {
    @apply bg-gray-200 text-gray-900 hover:bg-gray-300;
  }
</style>